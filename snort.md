












Step 1 – Update the System

Commands:

sudo apt update
sudo apt upgrade -y

<img width="732" height="256" alt="1" src="https://github.com/user-attachments/assets/41b0961d-9f46-4afe-9398-41fa05cb70ea" />

What I saw:
The package lists updated successfully and system packages were upgraded with no errors.

My note:
Keeping the system current ensures compatibility before installing Snort.

Step 2 – Install Snort

Command:

sudo apt install snort -y

<img width="732" height="256" alt="1" src="https://github.com/user-attachments/assets/c4b2d0a6-43ea-4c5e-9c0e-de03a574148d" />

What I saw:
Snort installed correctly. During setup it asked for the network interface and HOME_NET range.

Checked interface:

ip a


Result:
Interface ens33 with IP 192.168.92.129/24

Settings used:

Network Interface: ens33

HOME_NET: 192.168.92.0/24

My note:
These values define which local network Snort will monitor.

Step 3 – Configure Snort

Command:

sudo nano /etc/snort/snort.conf

<img width="851" height="447" alt="3 1" src="https://github.com/user-attachments/assets/5953b3d7-8ae9-4c66-bb5d-e314406dfaca" />

<img width="948" height="252" alt="3" src="https://github.com/user-attachments/assets/7bcf678e-6084-4a8a-a2b6-7779cf740e3c" />

What I changed:


ipvar HOME_NET 192.168.92.0/24


Check:

sudo grep HOME_NET /etc/snort/snort.conf


Output confirmed the line was updated.

My note:
HOME_NET now matches my subnet so Snort monitors the correct network.

Step 4 – Update and Manage Snort Rules

Commands:

sudo wget https://www.snort.org/downloads/community/community-rules.tar.gz
sudo tar -xvzf community-rules.tar.gz
sudo cp community-rules/* /etc/snort/rules/


What I saw:
Community rules downloaded and copied to /etc/snort/rules/.

Add custom rule:

sudo nano /etc/snort/rules/local.rules


Added this line:

alert icmp any any -> any any (msg:"ICMP detected"; sid:1000001; rev:1;)


My note:
This rule alerts whenever ICMP traffic (ping) is detected.

Which rules stood out: UPnP and MDNS discovery rules appeared interesting because they triggered later on real local traffic.

Purpose of rules: They tell Snort what patterns to look for in network packets to generate alerts.

Step 5 – Test Snort Configuration

Command:

sudo snort -T -c /etc/snort/snort.conf

<img width="808" height="549" alt="5" src="https://github.com/user-attachments/assets/6d343e1f-1515-454e-854b-da47f1a6f325" />

What I saw:

Snort successfully validated the configuration!
Snort exiting


My note:
All configuration and rules loaded correctly with only minor warnings.

Step 6 – Run Snort in IDS Mode

Command:

sudo snort -c /etc/snort/snort.conf -i ens33

<img width="725" height="449" alt="6" src="https://github.com/user-attachments/assets/3bdaba97-4b1d-412c-8e3b-c32f2910596f" />

What I saw:

Commencing packet processing (pid=2430)


Then I opened another terminal and ran:

ping 192.168.92.129


Alert displayed:

[**] [1:1000001:1] ICMP detected [**]
{ICMP} 192.168.92.130 -> 192.168.92.129


My note:
Snort successfully detected the ICMP packet generated by my ping test.

Step 7 – View Snort Logs

Commands:

cd /var/log/snort
ls -l
sudo cat snort.alert.fast
<img width="737" height="529" alt="7" src="https://github.com/user-attachments/assets/7c202bf0-5417-41e0-bbd4-4a20bbbc5d4b" />

<img width="733" height="520" alt="7 1" src="https://github.com/user-attachments/assets/e354fbc7-447d-43b1-a652-d2db1dfffa9c" />

What I saw:
Files present: snort.alert, snort.alert.fast, snort.log
snort.alert.fast contained entries like:

[**] [1:1917:6] SCAN UPnP service discover attempt [**]
[Classification: Detection of a Network Scan] [Priority: 3] {UDP} 192.168.92.1:61000 -> 239.255.255.250:1900


My note:
Snort logged normal network activity such as UPnP discovery.

Why some logs empty: Only traffic that matches rules creates entries; others stay empty.

Step 8 – Run Snort as a Daemon

Command:

sudo snort -D -c /etc/snort/snort.conf -i ens33
<img width="737" height="141" alt="8" src="https://github.com/user-attachments/assets/42bdf0df-f5cd-4990-9adc-7e5970eaef08" />


What I saw:

Spawning daemon child...
My daemon child 2496 lives...
Daemon parent exiting (0)


My note:
Snort runs in the background and continues logging traffic.
To verify: ps aux | grep snort
To stop: sudo pkill snort
